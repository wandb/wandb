name: Generate Docodile Documentation

env:
  # share an ssh-agent socket across jobs
  SSH_AUTH_SOCK: /tmp/ssh_agent.sock

on: # Whenever a release is published,
  release:
    types: [published]
  workflow_dispatch:
    inputs:
      ref:
        description: 'Reference (tag or commit sha) to generate docs from'
        required: false

jobs: # update the docs.
  update-docs:
    runs-on: ubuntu-latest
    steps:
      - name: Prepare wandb-branch value
        run: |
          REF_VALUE="${{ github.event.inputs.ref }}"
          if [[ "$REF_VALUE" == refs/tags/* ]]; then
          echo "wandb_branch=${REF_VALUE/refs\/tags\//}" >> "$GITHUB_ENV"
          else
          echo "wandb_branch=${{ github.ref }}" >> "$GITHUB_ENV"
          fi

      - name: test
        run: |
          echo ${{ steps.prepare.outputs.wandb_branch }}

#      - uses: wandb/docugen@v0.4.1
#        with:
#          docodile-branch: main
#          wandb-branch: ${{ steps.prepare.outputs.wandb_branch }}
#          generate-sdk-docs: true
#          generate-weave-docs: false
#          access-token: ${{ secrets.DOCUGEN_ACCESS_TOKEN }}
