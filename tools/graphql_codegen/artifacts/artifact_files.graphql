fragment FileFragment on File {
  __typename
  id
  name: displayName
  url
  sizeBytes
  storagePath @include(if: true) # Workaround: ensures generated pydantic field defaults to `None`
  mimetype
  updatedAt
  digest
  md5
  directUrl
}

query ArtifactVersionFiles(
  $entity: String!
  $project: String!
  $artifactType: String!
  $name: String!
  $fileNames: [String!]
  $cursor: String
  $perPage: Int = 50
) {
  project(name: $project, entityName: $entity) {
    artifactType(name: $artifactType) {
      artifact(name: $name) {
        files(names: $fileNames, after: $cursor, first: $perPage) {
          pageInfo {
            ...PageInfoFragment
          }
          edges {
            node {
              ...FileFragment
            }
          }
          totalCount @include(if: true) # Workaround: ensures generated pydantic field defaults to `None`
        }
      }
    }
  }
}

query ArtifactCollectionMembershipFiles(
  $entity: String!
  $project: String!
  $collection: String!
  $alias: String!
  $fileNames: [String!]
  $cursor: String
  $perPage: Int = 50
) {
  project(name: $project, entityName: $entity) {
    artifactCollection(name: $collection) {
      artifactMembership(aliasName: $alias) {
        files(names: $fileNames, after: $cursor, first: $perPage) {
          pageInfo {
            ...PageInfoFragment
          }
          edges {
            node {
              ...FileFragment
            }
          }
          totalCount @include(if: true) # Workaround: ensures generated pydantic field defaults to `None`
        }
      }
    }
  }
}

fragment FileWithUrlFragment on File {
  __typename
  name
  directUrl
}

query ArtifactCollectionMembershipFileUrls(
  $entity: String!
  $project: String!
  $collection: String!
  $alias: String!
  $cursor: String
  $perPage: Int
) {
  project(name: $project, entityName: $entity) {
    artifactCollection(name: $collection) {
      artifactMembership(aliasName: $alias) {
        files(after: $cursor, first: $perPage) {
          pageInfo {
            ...PageInfoFragment
          }
          edges {
            node {
              ...FileWithUrlFragment
            }
          }
        }
      }
    }
  }
}

query ArtifactFileUrls($id: ID!, $cursor: String, $perPage: Int) {
  artifact(id: $id) {
    files(after: $cursor, first: $perPage) {
      pageInfo {
        ...PageInfoFragment
      }
      edges {
        node {
          ...FileWithUrlFragment
        }
      }
    }
  }
}
